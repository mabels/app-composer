#!/usr/bin/env node

const appComposer = require("../dist/src/index");
const composer = require("../dist/src/composer");
const { findPathOfPackageJson } = require('../dist/src/global-watch');
const yargs = require("yargs");
const cwd = findPathOfPackageJson(process.cwd());
console.log(`Running Composer in [${cwd}]`);

const argv = require('yargs')
      .usage('Usage: $0 <command> [options]')
      .command('watchComposer', 'start the watching Compose Server', {}, (argv) => {
        composer.start(cwd);  // refactoring
      })
      .command('server', 'start the watching Compose Server', {}, (argv) => {
        appComposer.app(cwd); // refactoring
      })
      .command('compose', 'start the composing process', {}, (argv) => {
        appComposer.pkg(cwd); // refactoring
      })
      .argv;
